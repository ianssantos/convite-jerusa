<!DOCTYPE html>
<html lang="pt-BR">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Convite - 50 Anos de Jerusa</title>
    <script src="https://www.gstatic.com/firebasejs/8.10.0/firebase-app.js"></script>
    <script src="https://www.gstatic.com/firebasejs/8.10.0/firebase-firestore.js"></script>
    <style>
        :root {
            --rosa-cha: #e8b4b4;
            --rosa-cha-escuro: #d4a5a5;
            --rosa-cha-claro: #f7e6e6;
            --bege: #f5f1e8;
            --marrom-claro: #a78a7f;
            --texto: #5d4037;
            --branco: #ffffff;
        }
        
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
        }
        
        body {
            background-color: var(--bege);
            color: var(--texto);
            line-height: 1.6;
            background-image: url('data:image/svg+xml;utf8,<svg xmlns="http://www.w3.org/2000/svg" width="100" height="100" viewBox="0 0 100 100"><path fill="%23e8b4b4" opacity="0.1" d="M30,30 Q50,10 70,30 T90,50 Q70,70 50,90 T30,70 Q10,50 30,30 Z"/></svg>');
            background-size: 200px;
        }
        
        .container {
            max-width: 800px;
            margin: 0 auto;
            padding: 20px;
        }
        
        header {
            text-align: center;
            padding: 50px 0;
            background: linear-gradient(135deg, var(--rosa-cha), var(--marrom-claro));
            border-radius: 15px;
            margin-bottom: 30px;
            color: var(--branco);
            box-shadow: 0 8px 25px rgba(93, 64, 55, 0.15);
            position: relative;
            overflow: hidden;
            border: 1px solid var(--rosa-cha-escuro);
        }
        
        header::before {
            content: "üå∏";
            font-size: 120px;
            position: absolute;
            opacity: 0.15;
            top: 10px;
            right: 20px;
        }
        
        header::after {
            content: "";
            position: absolute;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            background: url('data:image/svg+xml;utf8,<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 100 100" width="100" height="100" opacity="0.05"><path fill="white" d="M50,10 C60,20 70,25 80,20 C90,15 85,30 90,40 C95,50 80,60 70,65 C60,70 50,80 40,75 C30,70 20,60 15,50 C10,40 25,30 20,20 C15,10 40,0 50,10 Z"/></svg>');
        }
        
        h1 {
            font-size: 2.8rem;
            margin-bottom: 15px;
            text-shadow: 2px 2px 4px rgba(93, 64, 55, 0.3);
            font-weight: 300;
            letter-spacing: 1px;
        }
        
        .subtitulo {
            font-size: 1.1rem;
            font-weight: 300;
            opacity: 0.9;
            line-height: 1.5;
            max-width: 90%;
            margin: 0 auto;
        }
        
        .contador {
            background-color: var(--branco);
            padding: 30px;
            border-radius: 15px;
            text-align: center;
            margin-bottom: 30px;
            box-shadow: 0 5px 20px rgba(93, 64, 55, 0.08);
            border: 1px solid var(--rosa-cha-claro);
        }
        
        .contador h2 {
            color: var(--marrom-claro);
            margin-bottom: 20px;
            font-weight: 400;
            font-size: 1.5rem;
        }
        
        .tempo {
            display: flex;
            justify-content: center;
            gap: 20px;
            margin-top: 25px;
        }
        
        .tempo-item {
            background: linear-gradient(135deg, var(--rosa-cha-claro), var(--rosa-cha));
            padding: 20px 15px;
            border-radius: 12px;
            min-width: 90px;
            box-shadow: 0 4px 8px rgba(212, 165, 165, 0.2);
            border: 1px solid var(--rosa-cha-escuro);
        }
        
        .tempo-numero {
            font-size: 2.2rem;
            font-weight: bold;
            color: var(--texto);
        }
        
        .tempo-texto {
            font-size: 0.9rem;
            margin-top: 8px;
            color: var(--marrom-claro);
            font-weight: 500;
        }
        
        .info-festa {
            background-color: var(--branco);
            padding: 25px;
            border-radius: 15px;
            margin-bottom: 30px;
            box-shadow: 0 5px 20px rgba(93, 64, 55, 0.08);
            border: 1px solid var(--rosa-cha-claro);
        }
        
        .info-festa h2 {
            color: var(--marrom-claro);
            margin-bottom: 15px;
            font-weight: 400;
            font-size: 1.5rem;
            text-align: center;
        }
        
        .info-item {
            display: flex;
            align-items: center;
            margin-bottom: 12px;
            padding: 10px;
            border-radius: 8px;
            transition: background-color 0.3s;
        }
        
        .info-item:hover {
            background-color: var(--rosa-cha-claro);
        }
        
        .info-item i {
            color: var(--rosa-cha);
            margin-right: 12px;
            font-size: 1.3rem;
            width: 25px;
            text-align: center;
        }
        
        .confirmacao {
            background-color: var(--branco);
            padding: 25px;
            border-radius: 15px;
            text-align: center;
            margin-bottom: 30px;
            box-shadow: 0 5px 20px rgba(93, 64, 55, 0.08);
            border: 1px solid var(--rosa-cha-claro);
        }
        
        .confirmacao h2 {
            color: var(--marrom-claro);
            margin-bottom: 15px;
            font-weight: 400;
            font-size: 1.5rem;
        }
        
        .form-group {
            margin-bottom: 15px;
            text-align: left;
        }
        
        label {
            display: block;
            margin-bottom: 6px;
            font-weight: 500;
            color: var(--texto);
        }
        
        input, select {
            width: 100%;
            padding: 12px;
            border: 1px solid var(--rosa-cha);
            border-radius: 10px;
            font-size: 1rem;
            transition: all 0.3s;
            background-color: var(--rosa-cha-claro);
        }
        
        input:focus, select:focus {
            outline: none;
            border-color: var(--marrom-claro);
            box-shadow: 0 0 0 3px rgba(167, 138, 127, 0.2);
            background-color: var(--branco);
        }
        
        button {
            background: linear-gradient(135deg, var(--rosa-cha), var(--marrom-claro));
            color: var(--branco);
            border: none;
            padding: 14px 30px;
            border-radius: 10px;
            font-size: 1rem;
            cursor: pointer;
            transition: all 0.3s;
            font-weight: 500;
            box-shadow: 0 4px 12px rgba(167, 138, 127, 0.3);
            letter-spacing: 0.5px;
        }
        
        button:hover {
            transform: translateY(-3px);
            box-shadow: 0 6px 18px rgba(167, 138, 127, 0.4);
        }
        
        button:active {
            transform: translateY(-1px);
        }
        
        button:disabled {
            opacity: 0.6;
            cursor: not-allowed;
            transform: none;
        }
        
        .placar {
            background-color: var(--branco);
            padding: 25px;
            border-radius: 15px;
            text-align: center;
            box-shadow: 0 5px 20px rgba(93, 64, 55, 0.08);
            border: 1px solid var(--rosa-cha-claro);
        }
        
        .placar h2 {
            color: var(--marrom-claro);
            margin-bottom: 15px;
            font-weight: 400;
            font-size: 1.5rem;
        }
        
        .contador-convidados {
            font-size: 2.8rem;
            font-weight: bold;
            color: var(--rosa-cha);
            margin: 20px 0;
            text-shadow: 2px 2px 4px rgba(232, 180, 180, 0.3);
        }
        
        .area-restrita {
            margin-top: 15px;
            padding: 18px;
            background-color: var(--rosa-cha-claro);
            border-radius: 10px;
            border: 1px dashed var(--rosa-cha);
        }
        
        .btn-restrito {
            background: linear-gradient(135deg, var(--marrom-claro), var(--rosa-cha-escuro));
            margin-bottom: 12px;
        }
        
        .form-senha {
            display: none;
            margin-top: 12px;
            padding: 18px;
            background-color: var(--branco);
            border-radius: 8px;
            border: 1px solid var(--rosa-cha);
        }
        
        .lista-convidados {
            text-align: left;
            max-height: 250px;
            overflow-y: auto;
            margin-top: 15px;
            border: 1px solid var(--rosa-cha-claro);
            border-radius: 10px;
            padding: 12px;
            background-color: var(--rosa-cha-claro);
            display: none;
        }
        
        .convidado-item {
            padding: 10px 12px;
            border-bottom: 1px solid var(--rosa-cha);
            display: flex;
            justify-content: space-between;
            transition: background-color 0.3s;
            border-radius: 6px;
            margin-bottom: 4px;
        }
        
        .convidado-item:hover {
            background-color: rgba(255, 255, 255, 0.7);
        }
        
        .convidado-item:last-child {
            border-bottom: none;
            margin-bottom: 0;
        }
        
        .loading {
            text-align: center;
            color: var(--marrom-claro);
            padding: 15px;
            font-style: italic;
        }
        
        .mensagem-hoje {
            background: linear-gradient(135deg, var(--rosa-cha), var(--marrom-claro));
            color: white;
            padding: 20px;
            border-radius: 12px;
            font-weight: 500;
            margin: 12px 0;
            text-align: center;
            animation: pulse 2s infinite;
            box-shadow: 0 6px 15px rgba(167, 138, 127, 0.4);
        }
        
        .mensagem-erro {
            color: #d32f2f;
            background-color: #ffebee;
            padding: 8px;
            border-radius: 5px;
            margin-top: 8px;
            text-align: center;
            border: 1px solid #f44336;
            display: none;
        }
        
        @keyframes pulse {
            0% { transform: scale(1); }
            50% { transform: scale(1.02); }
            100% { transform: scale(1); }
        }
        
        footer {
            text-align: center;
            margin-top: 40px;
            padding: 20px;
            color: var(--marrom-claro);
            font-size: 0.95rem;
            border-top: 1px solid var(--rosa-cha-claro);
        }
        
        .detalhe-floral {
            display: block;
            margin: 8px auto;
            font-size: 1.3rem;
        }
        
        .versiculo {
            font-style: italic;
            margin-top: 8px;
            color: var(--marrom-claro);
            font-size: 0.9rem;
            line-height: 1.4;
        }
        
        /* Scrollbar personalizado */
        .lista-convidados::-webkit-scrollbar {
            width: 8px;
        }
        
        .lista-convidados::-webkit-scrollbar-track {
            background: var(--rosa-cha-claro);
            border-radius: 10px;
        }
        
        .lista-convidados::-webkit-scrollbar-thumb {
            background: var(--rosa-cha);
            border-radius: 10px;
        }
        
        .lista-convidados::-webkit-scrollbar-thumb:hover {
            background: var(--marrom-claro);
        }
        
        @media (max-width: 600px) {
            h1 {
                font-size: 2.2rem;
            }
            
            .subtitulo {
                font-size: 1rem;
            }
            
            .tempo {
                flex-wrap: wrap;
                gap: 10px;
            }
            
            .tempo-item {
                min-width: 80px;
                padding: 15px 10px;
            }
            
            .tempo-numero {
                font-size: 1.8rem;
            }
            
            header::before {
                font-size: 80px;
                top: 20px;
                right: 10px;
            }
            
            .container {
                padding: 15px;
            }
        }
    </style>
</head>
<body>
    <div class="container">
        <header>
            <h1>50 Anos de Jerusa</h1>
            <p class="subtitulo">üôè Deus tem sido fiel em cada cap√≠tulo da minha hist√≥ria. Venha agradecer e festejar comigo meus 50 anos.</p>
        </header>
        
        <section class="contador">
            <h2>Contagem Regressiva</h2>
            <div id="contador-dias">
                <!-- A contagem ser√° inserida aqui via JavaScript -->
            </div>
        </section>
        
        <section class="info-festa">
            <h2>Informa√ß√µes da Festa</h2>
            <div class="info-item">
                <i>üìÖ</i>
                <div>
                    <strong>Data:</strong> 24 de Dezembro de 2025
                </div>
            </div>
            <div class="info-item">
                <i>‚è∞</i>
                <div>
                    <strong>Hor√°rio:</strong> A partir das 19h
                </div>
            </div>
            <div class="info-item">
                <i>üìç</i>
                <div>
                    <strong>Local:</strong> Bellagio Residence
                </div>
            </div>
            <div class="info-item">
                <i>üíù</i>
                <div>
                    <strong>Sua presen√ßa √© o melhor presente!</strong>
                </div>
            </div>
        </section>
        
        <section class="confirmacao">
            <h2>Confirme sua Presen√ßa</h2>
            <form id="form-confirmacao">
                <div class="form-group">
                    <label for="nome">Seu Nome Completo</label>
                    <input type="text" id="nome" required placeholder="Digite seu nome completo">
                </div>
                <div class="form-group">
                    <label for="acompanhantes">N√∫mero de Acompanhantes</label>
                    <select id="acompanhantes">
                        <option value="0">Nenhum - Vou sozinho(a)</option>
                        <option value="1">1 pessoa</option>
                        <option value="2">2 pessoas</option>
                        <option value="3">3 pessoas</option>
                        <option value="4">4 pessoas</option>
                        <option value="5">5 pessoas</option>
                    </select>
                </div>
                <button type="submit" id="btn-confirmar">Confirmar Presen√ßa</button>
            </form>
        </section>
        
        <section class="placar">
            <h2>Convidados Confirmados</h2>
            <div class="contador-convidados" id="total-convidados">
                <div class="loading">Carregando...</div>
            </div>
            <p>pessoas confirmadas at√© o momento</p>
            
            <div class="area-restrita">
                <button class="btn-restrito" id="btn-visualizar-convidados">
                    üîí Visualizar Lista de Convidados
                </button>
                
                <div class="form-senha" id="form-senha">
                    <div class="form-group">
                        <label for="senha">√â voc√™, Jerusa? Digite a senha:</label>
                        <input type="password" id="senha" placeholder="Digite a senha de acesso">
                    </div>
                    <button type="button" id="btn-verificar-senha">Acessar Lista</button>
                    <div class="mensagem-erro" id="mensagem-erro">
                        Senha incorreta! Tente novamente.
                    </div>
                </div>
                
                <div class="lista-convidados" id="lista-convidados">
                    <div class="loading">Carregando confirma√ß√µes...</div>
                </div>
            </div>
        </section>
        
        <footer>
            <span class="detalhe-floral">üåπ</span>
            <p>Com carinho, aguardamos sua presen√ßa</p>
            <p>üíï 50 anos de amor, alegria e conquistas! üíï</p>
            <p class="versiculo">üìñ Salmos 23:6 "Bondade e miseric√≥rdia certamente me seguir√£o todos os dias da minha vida."</p>
        </footer>
    </div>

    <script>
        // =============================================
        // CONFIGURA√á√ÉO DO FIREBASE
        // =============================================
        const firebaseConfig = {
            apiKey: "AIzaSyBFo3GMGixsPpQ2jEEAIlrGwubJHxVnxgA",
            authDomain: "convite-jerusa.firebaseapp.com",
            projectId: "convite-jerusa",
            storageBucket: "convite-jerusa.firebasestorage.app",
            messagingSenderId: "146816066560",
            appId: "1:146816066560:web:cc415cb36af25ca332e4e5"
        };

        // Inicializar Firebase
        firebase.initializeApp(firebaseConfig);
        const db = firebase.firestore();

        // Data do anivers√°rio
        const dataAniversario = new Date('2025-12-24T19:00:00');
        
        // Elementos DOM
        const contadorDiasEl = document.getElementById('contador-dias');
        const formConfirmacao = document.getElementById('form-confirmacao');
        const btnConfirmar = document.getElementById('btn-confirmar');
        const totalConvidadosEl = document.getElementById('total-convidados');
        const listaConvidadosEl = document.getElementById('lista-convidados');
        const btnVisualizarConvidados = document.getElementById('btn-visualizar-convidados');
        const formSenha = document.getElementById('form-senha');
        const btnVerificarSenha = document.getElementById('btn-verificar-senha');
        const mensagemErro = document.getElementById('mensagem-erro');
        
        // Senha de acesso (pode ser alterada)
        const SENHA_CORRETA = "@surej";
        
        // Atualizar contador de dias
        function atualizarContador() {
            const hoje = new Date();
            const diferenca = dataAniversario - hoje;
            const dias = Math.ceil(diferenca / (1000 * 60 * 60 * 24));
            
            if (dias === 0) {
                const horas = Math.ceil((dataAniversario - hoje) / (1000 * 60 * 60));
                if (horas > 0) {
                    contadorDiasEl.innerHTML = `
                        <div class="mensagem-hoje">
                            <h2>√â HOJE! üéâ</h2>
                            <p>Faltam apenas ${horas} horas para a festa!</p>
                        </div>
                    `;
                } else {
                    contadorDiasEl.innerHTML = `
                        <div class="mensagem-hoje">
                            <h2>A FESTA COME√áOU! üéä</h2>
                            <p>Seja bem-vindo(a)!</p>
                        </div>
                    `;
                }
            } else if (dias < 0) {
                contadorDiasEl.innerHTML = `
                    <div style="text-align: center; color: var(--marrom-claro); padding: 20px;">
                        <h2>A festa j√° aconteceu! ü•≥</h2>
                        <p>Obrigado a todos que tornaram este dia especial!</p>
                    </div>
                `;
            } else {
                contadorDiasEl.innerHTML = `
                    <p>Faltam apenas</p>
                    <div class="tempo">
                        <div class="tempo-item">
                            <div class="tempo-numero">${dias}</div>
                            <div class="tempo-texto">dias</div>
                        </div>
                    </div>
                    <p>para a grande celebra√ß√£o!</p>
                `;
            }
        }
        
        // Carregar confirma√ß√µes do Firebase (apenas contagem)
        function carregarConfirmacoes() {
            db.collection('confirmacoes')
                .onSnapshot((snapshot) => {
                    let totalPessoas = 0;
                    
                    snapshot.forEach((doc) => {
                        const convidado = doc.data();
                        const numAcompanhantes = parseInt(convidado.acompanhantes);
                        totalPessoas += 1 + numAcompanhantes;
                    });
                    
                    totalConvidadosEl.innerHTML = totalPessoas;
                }, (error) => {
                    console.error('Erro ao carregar confirma√ß√µes:', error);
                    totalConvidadosEl.innerHTML = '0';
                });
        }
        
        // Carregar lista completa de convidados (ap√≥s autentica√ß√£o)
        function carregarListaCompleta() {
            db.collection('confirmacoes')
                .orderBy('dataConfirmacao', 'desc')
                .get()
                .then((snapshot) => {
                    let listaHTML = '';
                    
                    if (snapshot.empty) {
                        listaHTML = '<p style="text-align: center; padding: 20px;">Nenhum convidado confirmado ainda.</p>';
                    } else {
                        snapshot.forEach((doc) => {
                            const convidado = doc.data();
                            const numAcompanhantes = parseInt(convidado.acompanhantes);
                            
                            const textoAcompanhantes = numAcompanhantes > 0 ? 
                                `+${numAcompanhantes} acompanhante(s)` : ' (Sozinho(a))';
                            
                            // Formatar data
                            const data = convidado.dataConfirmacao.toDate();
                            const dataFormatada = data.toLocaleDateString('pt-BR');
                            
                            listaHTML += `
                                <div class="convidado-item">
                                    <div>
                                        <strong>${convidado.nome}</strong><br>
                                        <small>Confirmado em: ${dataFormatada}</small>
                                    </div>
                                    <span>${textoAcompanhantes}</span>
                                </div>
                            `;
                        });
                    }
                    
                    listaConvidadosEl.innerHTML = listaHTML;
                    listaConvidadosEl.style.display = 'block';
                })
                .catch((error) => {
                    console.error('Erro ao carregar lista completa:', error);
                    listaConvidadosEl.innerHTML = '<p style="text-align: center; color: var(--marrom-claro);">Erro ao carregar lista. Tente novamente.</p>';
                });
        }
        
        // Manipular envio do formul√°rio de confirma√ß√£o
        formConfirmacao.addEventListener('submit', async function(e) {
            e.preventDefault();
            
            const nome = document.getElementById('nome').value.trim();
            const acompanhantes = document.getElementById('acompanhantes').value;
            
            if (!nome) {
                alert('Por favor, digite seu nome.');
                return;
            }
            
            // Desabilitar bot√£o para evitar m√∫ltiplos cliques
            btnConfirmar.disabled = true;
            btnConfirmar.textContent = 'Confirmando...';
            
            try {
                // Verificar se o nome j√° existe (case insensitive)
                const snapshot = await db.collection('confirmacoes')
                    .where('nome', '==', nome)
                    .get();
                
                if (!snapshot.empty) {
                    alert(`${nome}, voc√™ j√° confirmou sua presen√ßa! ‚ù§Ô∏è`);
                } else {
                    // Adicionar nova confirma√ß√£o
                    await db.collection('confirmacoes').add({
                        nome: nome,
                        acompanhantes: acompanhantes,
                        dataConfirmacao: new Date(),
                        timestamp: firebase.firestore.FieldValue.serverTimestamp()
                    });
                    
                    alert(`Obrigado, ${nome}! Sua presen√ßa foi confirmada com sucesso! üéâ`);
                    formConfirmacao.reset();
                }
            } catch (error) {
                console.error('Erro ao confirmar presen√ßa:', error);
                alert('Erro ao confirmar presen√ßa. Tente novamente.');
            } finally {
                // Reabilitar bot√£o
                btnConfirmar.disabled = false;
                btnConfirmar.textContent = 'Confirmar Presen√ßa';
            }
        });
        
        // Mostrar formul√°rio de senha
        btnVisualizarConvidados.addEventListener('click', function() {
            formSenha.style.display = 'block';
            btnVisualizarConvidados.style.display = 'none';
            mensagemErro.style.display = 'none';
        });
        
        // Verificar senha
        btnVerificarSenha.addEventListener('click', function() {
            const senhaDigitada = document.getElementById('senha').value;
            
            if (senhaDigitada === SENHA_CORRETA) {
                // Senha correta - mostrar lista
                formSenha.style.display = 'none';
                carregarListaCompleta();
                mensagemErro.style.display = 'none';
            } else {
                // Senha incorreta
                mensagemErro.style.display = 'block';
                document.getElementById('senha').value = '';
                document.getElementById('senha').focus();
            }
        });
        
        // Permitir pressionar Enter no campo de senha
        document.getElementById('senha').addEventListener('keypress', function(e) {
            if (e.key === 'Enter') {
                btnVerificarSenha.click();
            }
        });
        
        // Inicializar
        document.addEventListener('DOMContentLoaded', function() {
            atualizarContador();
            carregarConfirmacoes();
            
            // Atualizar contador a cada minuto
            setInterval(atualizarContador, 60000);
        });
    </script>
</body>
</html>